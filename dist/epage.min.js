/*!
 * epage v0.7.1
 * (c) 2020-present Chengzi
 * Released under the MIT License.
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("epage-core"),require("iview"),require("vue"),require("vuex")):"function"==typeof define&&define.amd?define("Epage",["epage-core","iview","vue","vuex"],t):"object"==typeof exports?exports.Epage=t(require("epage-core"),require("iview"),require("vue"),require("vuex")):e.Epage=t(e.EpageCore,e.iview,e.Vue,e.Vuex)}(window,function(e,t,s,i){return function(e){var t={};function s(i){if(t[i])return t[i].exports;var a=t[i]={i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,s),a.l=!0,a.exports}return s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(i,a,function(t){return e[t]}.bind(null,a));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=4)}([function(t,s){t.exports=e},function(e,s){e.exports=t},function(e,t){e.exports=s},function(e,t){e.exports=i},function(e,t,s){"use strict";s.r(t);var i=s(0),a=s(2),r=s.n(a),o=s(1),n=s.n(o),l=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ep-editor"},[s("ep-header",{attrs:{header:e.panels.header,store:e.store,"design-view":e.design,ready:e.ready},on:{"change-view":e.renderDesignView,preview:e.onPreview,"show-schema":e.showSchemaPanel,"show-logic":e.showLogicPanel}}),s("div",{staticClass:"ep-side-left"},[e._e(),s("div",{staticClass:"ep-side-left-content"},[s("div",{directives:[{name:"show",rawName:"v-show",value:"widget"===e.nav.active,expression:'nav.active === "widget"'}],staticClass:"ep-tool"},[s("ep-tool",{attrs:{widgets:e.widgets},on:{"on-add":e.onAddWidget}})],1),s("ep-store",{directives:[{name:"show",rawName:"v-show",value:"store"===e.nav.active,expression:'nav.active === "store"'}],attrs:{store:e.store}})],1)]),s("div",{directives:[{name:"show",rawName:"v-show",value:"store"===e.nav.active,expression:'nav.active === "store"'}],staticClass:"ep-side-right"},[s("ep-store-setting",{directives:[{name:"show",rawName:"v-show",value:"store"===e.nav.active,expression:'nav.active === "store"'}],attrs:{store:e.store}})],1),s("div",{directives:[{name:"show",rawName:"v-show",value:"widget"===e.nav.active,expression:'nav.active === "widget"'}],staticClass:"ep-work",class:{"ep-work-expand":e.settingState.fold}},[s("ep-panel",{staticClass:"ep-work-design"},[s("div",{directives:[{name:"show",rawName:"v-show",value:"pc"===e.design.view,expression:'design.view === "pc"'}]},[s("div",{ref:"design-pc",staticClass:"design-pc"})]),s("div",{directives:[{name:"show",rawName:"v-show",value:"h5"===e.design.view,expression:'design.view === "h5"'}]},[s("ep-h5-emulator",[s("div",{ref:"design-h5",staticClass:"design-h5"})])],1)])],1),s("div",{directives:[{name:"show",rawName:"v-show",value:"widget"===e.nav.active,expression:'nav.active === "widget"'}],staticClass:"ep-setting",class:{"ep-setting-fold":e.settingState.fold}},[s("ep-setting",{attrs:{store:e.store,settings:e.settings}}),s("div",{staticClass:"ep-control-handle",on:{click:e.onUnfold}},[e._v(e._s(e.settingState.text))])],1),s("ep-fullscreen",{attrs:{visible:!!e.preview.view},on:{"on-close":e.closePreview}},[s("div",{staticStyle:{"font-size":"12px","font-weight":"normal","text-align":"center"},attrs:{slot:"header"},slot:"header"},[e.ready.pc&&e.ready.h5?s("RadioGroup",{staticClass:"ep-preview-header-view",attrs:{type:"button",size:"small"},on:{"on-change":e.changePreview},model:{value:e.preview.view,callback:function(t){e.$set(e.preview,"view",t)},expression:"preview.view"}},[s("Radio",{attrs:{label:"pc"}},[e._v("PC")]),s("Radio",{attrs:{label:"h5"}},[e._v("H5")])],1):e._e()],1),[s("div",{ref:"preview-pc",staticClass:"ep-preview-pc"})],s("div",{directives:[{name:"show",rawName:"v-show",value:"h5"===e.preview.view,expression:'preview.view === "h5"'}]},[s("ep-h5-emulator",[s("div",{ref:"preview-h5"})])],1)],2),s("ep-fullscreen",{attrs:{visible:!!e.schemaPanel.visible},on:{"on-close":e.closeSchemaPanel}},[s("div",{attrs:{slot:"header"},slot:"header"},[s("span",[e._v("Schema")])]),e.schemaPanel.visible?s("ep-schema",{attrs:{store:e.store},model:{value:e.rootSchema,callback:function(t){e.rootSchema=t},expression:"rootSchema"}}):e._e()],1),s("ep-fullscreen",{attrs:{visible:!!e.logicPanel.visible},on:{"on-close":e.closeLogicPanel}},[s("div",{attrs:{slot:"header"},slot:"header"},[s("span",[e._v("Logic")])]),e.logicPanel.visible?s("ep-logic",{attrs:{store:e.store}}):e._e()],1)],1)};l._withStripped=!0;var c=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ep-setting-block",{attrs:{title:e.title}},[e._t("before"),s("Row",[s("Col",{staticStyle:{"margin-bottom":"8px"},attrs:{span:"8",offset:"8"}},[s("Input",{attrs:{size:"small"},model:{value:e.styles[e.prefix+"top"],callback:function(t){e.$set(e.styles,e.prefix+"top",t)},expression:"styles[`${prefix}top`]"}},[s("span",{attrs:{slot:"prepend"},slot:"prepend"},[e._v("上")])])],1),s("Col",{staticStyle:{"margin-bottom":"8px"},attrs:{span:"8",offset:"2"}},[s("Input",{attrs:{size:"small"},model:{value:e.styles[e.prefix+"left"],callback:function(t){e.$set(e.styles,e.prefix+"left",t)},expression:"styles[`${prefix}left`]"}},[s("span",{attrs:{slot:"prepend"},slot:"prepend"},[e._v("左")])])],1),s("Col",{staticStyle:{"margin-bottom":"8px"},attrs:{span:"8",offset:"2"}},[s("Input",{attrs:{size:"small"},model:{value:e.styles[e.prefix+"right"],callback:function(t){e.$set(e.styles,e.prefix+"right",t)},expression:"styles[`${prefix}right`]"}},[s("span",{attrs:{slot:"prepend"},slot:"prepend"},[e._v("右")])])],1),s("Col",{staticStyle:{"margin-bottom":"8px"},attrs:{span:"8",offset:"8"}},[s("Input",{attrs:{size:"small"},model:{value:e.styles[e.prefix+"bottom"],callback:function(t){e.$set(e.styles,e.prefix+"bottom",t)},expression:"styles[`${prefix}bottom`]"}},[s("span",{attrs:{slot:"prepend"},slot:"prepend"},[e._v("下")])])],1)],1),e._t("after"),e._t("default")],2)};c._withStripped=!0;var p=function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"ep-setting-block"},[this.title?t("h5",{staticClass:"ep-setting-block-title"},[this._v(this._s(this.title))]):this._e(),t("div",{staticClass:"ep-setting-block-content"},[this._t("default")],2)])};function d(e,t,s,i,a,r,o,n){var l,c="function"==typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=s,c._compiled=!0),i&&(c.functional=!0),r&&(c._scopeId="data-v-"+r),o?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),a&&a.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(o)},c._ssrRegister=l):a&&(l=n?function(){a.call(this,this.$root.$options.shadowRoot)}:a),l)if(c.functional){c._injectStyles=l;var p=c.render;c.render=function(e,t){return l.call(t),p(e,t)}}else{var d=c.beforeCreate;c.beforeCreate=d?[].concat(d,l):[l]}return{exports:e,options:c}}p._withStripped=!0;var u=d({props:{title:{type:String,default:""}}},p,[],!1,null,null,null);u.options.__file="src/components/setting-block/index.vue";var h=u.exports,m={margin:"margin-",padding:"padding-",position:""},v=d({components:{EpSettingBlock:h},props:{styles:{type:Object,default:()=>({})},type:{type:String,default:"margin"},title:{type:String,default:""}},computed:{prefix(){return m[this.type]||""}}},c,[],!1,null,null,null);v.options.__file="src/components/setting-bounding/index.vue";var g=v.exports,f=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ep-setting-block",{attrs:{title:e.title}},[s("Row",{staticStyle:{"padding-top":"8px"}},[s("Col",{attrs:{span:"10"}},[s("FormItem",{attrs:{label:"背景色","label-width":50}},[s("ColorPicker",{staticClass:"ep-style-color-picker",attrs:{size:"small",alpha:!0},model:{value:e.schema.style.container["background-color"],callback:function(t){e.$set(e.schema.style.container,"background-color",t)},expression:'schema.style.container["background-color"]'}})],1)],1),s("Col",{attrs:{span:"14"}},[s("FormItem",{attrs:{label:"RGB","label-width":50}},[s("Input",{attrs:{size:"small"},model:{value:e.schema.style.container["background-color"],callback:function(t){e.$set(e.schema.style.container,"background-color",t)},expression:'schema.style.container["background-color"]'}})],1)],1)],1),e._l(e.schema.style.container.background,function(t,i){return s("div",{key:i,staticClass:"ep-style-background-item"},[s("h4",{staticClass:"ep-style-background-item-title"},[s("span",[e._v("背景-"+e._s(i+1))]),s("div",{staticClass:"ep-style-background-item-option"},[s("i",{staticClass:"ep-style-background-up ep-icon ep-icon-up",class:{disabled:0===i},attrs:{title:"上移"},on:{click:function(t){return e.moveBackground(i-1)}}}),s("i",{staticClass:"ep-style-background-down ep-icon ep-icon-down",class:{disabled:i+1===e.schema.style.container.background.length},attrs:{title:"下移"},on:{click:function(t){return e.moveBackground(i)}}}),s("i",{staticClass:"ep-style-background-delete ep-icon ep-icon-close",attrs:{title:"删除"},on:{click:function(t){return e.deleteBackground(i)}}})])]),s("Row",{staticStyle:{"padding-top":"8px"}},[s("Col",{attrs:{span:"24"}},[s("FormItem",{attrs:{label:"图片","label-width":50}},[s("Input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:8},placeholder:"示例: http://test.com/abc.jpg",size:"small"},model:{value:t.image,callback:function(s){e.$set(t,"image",s)},expression:"bg.image"}})],1),s("FormItem",{attrs:{label:"重复","label-width":50}},[s("Select",{attrs:{size:"small"},model:{value:t.repeat,callback:function(s){e.$set(t,"repeat",s)},expression:"bg.repeat"}},[s("Option",{attrs:{value:"no-repeat"}},[e._v("不重复")]),s("Option",{attrs:{value:"repeat"}},[e._v("水平垂直重复")]),s("Option",{attrs:{value:"repeat-x"}},[e._v("水平重复")]),s("Option",{attrs:{value:"repeat-y"}},[e._v("垂直重复")])],1)],1),s("FormItem",{attrs:{label:"尺寸","label-width":50}},[s("RadioGroup",{attrs:{value:e.getBgSize(t.size),size:"small"},on:{"on-change":function(t){for(var s=arguments.length,a=Array(s);s--;)a[s]=arguments[s];return e.onSizeChange.apply(void 0,[i].concat(a))}}},[s("Radio",{attrs:{label:"cover"}},[e._v("覆盖")]),s("Radio",{attrs:{label:"contain"}},[e._v("适配")]),s("Radio",{attrs:{label:"custom"}},[e._v("自定义")])],1)],1),"custom"===e.getBgSize(t.size)?s("FormItem",{attrs:{"label-width":50}},[s("Input",{attrs:{size:"small",placeholder:"如: 100% 100%"},model:{value:t.size,callback:function(s){e.$set(t,"size",s)},expression:"bg.size"}})],1):e._e(),s("FormItem",{staticClass:"ep-style-background-position",attrs:{label:"位置","label-width":50}},[s("RadioGroup",{attrs:{type:"button",size:"large"},model:{value:t.position,callback:function(s){e.$set(t,"position",s)},expression:"bg.position"}},e._l(e.BG_POSITIONS_1,function(t){return s("Radio",{key:t.key,attrs:{label:t.key}},[e._v(e._s(t.value))])}),1),s("RadioGroup",{attrs:{type:"button",size:"large"},model:{value:t.position,callback:function(s){e.$set(t,"position",s)},expression:"bg.position"}},e._l(e.BG_POSITIONS_2,function(t){return s("Radio",{key:t.key,attrs:{label:t.key}},[e._v(e._s(t.value))])}),1),s("RadioGroup",{attrs:{type:"button",size:"large"},model:{value:t.position,callback:function(s){e.$set(t,"position",s)},expression:"bg.position"}},e._l(e.BG_POSITIONS_3,function(t){return s("Radio",{key:t.key,attrs:{label:t.key}},[e._v(e._s(t.value))])}),1),s("RadioGroup",{staticStyle:{width:"138px"},attrs:{value:e.getBgPosition(t.position),type:"button",size:"small"},on:{"on-change":function(t){for(var s=arguments.length,a=Array(s);s--;)a[s]=arguments[s];return e.onPositionChange.apply(void 0,[i].concat(a))}}},[s("Radio",{staticStyle:{width:"100%"},attrs:{label:"custom"}},[e._v("自定义")])],1)],1),"custom"===e.getBgPosition(t.position)?s("FormItem",{attrs:{"label-width":50}},[s("Input",{staticStyle:{width:"138px"},attrs:{size:"small"},model:{value:t.position,callback:function(s){e.$set(t,"position",s)},expression:"bg.position"}})],1):e._e()],1)],1)],1)}),s("div",{staticStyle:{"text-align":"center",padding:"6px"}},[s("Button",{attrs:{size:"small"},on:{click:e.addBackground}},[e._v("+ 添加背景图")])],1)],2)};function y(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,i)}return s}function b(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}f._withStripped=!0;var _=d({components:{EpSettingBlock:h},props:{title:{type:String,default:""},root:{type:Boolean,default:!1},schema:{type:Object,default:()=>({style:{}})},store:{type:Object,default:()=>({state:{}})}},data:()=>({BG_SIZES:[{key:"cover",value:"覆盖"},{key:"contain",value:"适配"}],BG_POSITIONS_1:[{key:"top left",value:"↖"},{key:"top center",value:"↑"},{key:"top right",value:"↗"}],BG_POSITIONS_2:[{key:"center left",value:"←"},{key:"center center",value:"·"},{key:"center right",value:"→"}],BG_POSITIONS_3:[{key:"bottom left",value:"↙"},{key:"bottom center",value:"↓"},{key:"bottom right",value:"↘"}]}),methods:{addBackground(){this.updateBackground(e=>{var t=new i.style.Background;return e.push(t),e})},deleteBackground(e){this.updateBackground(t=>(t.splice(e,1),t))},moveBackground(e){this.updateBackground(t=>{var s=t[e],i=t[e+1];return t.splice(e,1,i),t.splice(e+1,1,s),t})},updateBackground(e){var{key:t}=this.schema,s=this.root?null:t,i=function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?y(Object(s),!0).forEach(function(t){b(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):y(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}({},this.schema.style.container),a=[...i.background||[]];a=e(a),i.background=a,this.store.updateStyle(s,{container:i})},onSizeChange(e,t){this.updateBackground(s=>{return s[e].size=this.BG_SIZES.filter(e=>e.key===t).length?t:"100% 100%",s})},getBgSize(e){return this.BG_SIZES.filter(t=>t.key===e).length?e:"custom"},getBgPosition(e){return this.includePosition(e)?e:"custom"},onPositionChange(e,t){this.updateBackground(s=>{return s[e].position=this.includePosition(t)?t:"",s})},includePosition(e){return!![...this.BG_POSITIONS_1,...this.BG_POSITIONS_2,...this.BG_POSITIONS_3].filter(t=>t.key===e).length}}},f,[],!1,null,null,null);_.options.__file="src/components/setting-background/index.vue";var w=_.exports,k=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ep-code-editor"},[s("div",{staticClass:"ep-code-editor-bar"},[s("span",{staticClass:"ep-code-editor-summary"},[s("b",[e._v(e._s(e.code.lines))]),s("span",[e._v(" lines")])]),e._t("bar")],2),e.code.lines>1?s("pre",{staticClass:"ep-code-editor-content",domProps:{innerHTML:e._s(e.code.content)}}):e._e()])};k._withStripped=!0;var S=d({props:{value:{type:String,default:""},lang:{type:String,default:""}},computed:{code(){return this.getCode()}},methods:{getCode(){var e=this.value;switch(this.lang){case"json":e=this.getJSONString(this.value);break;default:e=this.format(this.value)}return e},getJSONString(e){return this.format(e)},format(e){var t=this.clean(e);return this.line(t)},clean:e=>e.replace(/</g,"&lt;").replace(/>/g,"&gt;"),line(e){var t=1,s=(e='<div class="line">'.concat(e,"</div>")).replace(/\n/g,()=>(t++,'</div><div class="line">'));return{lines:t,content:s}}}},k,[],!1,null,null,null);S.options.__file="src/components/code-editor/index.vue";var x=S.exports,C=function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"ep-h5-emulator"},[t("div",{staticClass:"ep-h5-emulator-bar"}),t("div",{staticClass:"ep-h5-emulator-device"},[t("div",{staticClass:"ep-h5-emulator-body"},[this._t("default")],2)])])};C._withStripped=!0;var $=d({data:()=>({})},C,[],!1,null,null,null);$.options.__file="src/components/h5-emulator/index.vue";var P=$.exports,I=function(){var e=this.$createElement,t=this._self._c||e;return t("div",{directives:[{name:"show",rawName:"v-show",value:this.visible,expression:"visible"}],staticClass:"ep-fullscreen"},[this.$slots.header?t("div",{staticClass:"ep-fullscreen-header"},[this._t("header"),t("span",{staticClass:"ep-fullscreen-close ep-icon ep-icon-close",on:{click:this.onClose}})],2):this._e(),t("div",{staticClass:"ep-fullscreen-body"},[this._t("default")],2)])};I._withStripped=!0;var O=d({props:{visible:{type:Boolean,default:!1}},methods:{onClose(){this.$emit("on-close")}}},I,[],!1,null,null,null);O.options.__file="src/components/fullscreen/index.vue";var R=O.exports,E=function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"ep-panel"},[this.title?[t("h3",{staticClass:"ep-panel-title"},[this._v(this._s(this.title))]),t("div",{staticClass:"ep-panel-content"},[this._t("default")],2)]:[this._t("default")]],2)};E._withStripped=!0;var z=d({props:{title:{type:String,default:""}}},E,[],!1,null,null,null);z.options.__file="src/components/panel/index.vue";var j=z.exports,L=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ep-tabs"},[s("div",{staticClass:"ep-tabs-nav"},e._l(e.tabs,function(t,i){return s("div",{key:t.key,staticClass:"ep-tabs-nav-item",class:{"ep-tabs-nav-item-active":e.value===t.key},on:{click:function(s){return e.onClick(t.key,i)}}},[e._v(e._s(t.name))])}),0),s("div",{staticClass:"ep-tabs-content-wrap"},[s("div",{staticClass:"ep-tabs-content"},[e._t("default")],2)])])};L._withStripped=!0;var B=d({name:"EpTabs",props:{value:{type:String,default:""},tabs:{type:Array,default:()=>[]}},data:()=>({current:""}),watch:{value(e){this.setCurrent(e)}},methods:{onClick(e,t){this.$emit("on-click",e,t)},setCurrent(e){this.current=e,this.$emit("input",e)}}},L,[],!1,null,null,null);B.options.__file="src/components/tabs/index.vue";var F=B.exports,T=function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"ep-tabs-pane"},[this._t("default")],2)};T._withStripped=!0;var A=d({name:"EpTabsPane",props:{label:{type:String,default:""},name:{type:String,default:""}}},T,[],!1,null,null,null);A.options.__file="src/components/tabs-pane/index.vue";var D=A.exports,V=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ep-store"},[s("div",{staticClass:"ep-store-dict"},[s("div",{staticClass:"ep-store-dict-btns"},[s("Button",{attrs:{type:"primary",size:"small"},on:{click:e.onNewDict}},[e._v("+ 添加字典")])],1),s("div",{staticClass:"ep-store-dict-item"},[s("div",{staticClass:"ep-store-dict-info"},[s("ep-store-more",[s("ep-store-more-item",{nativeOn:{click:function(t){return e.onDictToggle(t)}}},[e._v("收展")])],1),s("p",{staticClass:"ep-store-dict-name"},[e._v("自定义API")])],1),e._l(e.apis,function(t,i){return s("div",{key:t.name,staticClass:"ep-store-dict-api",class:e.getAPIClass(i,-1),on:{click:function(t){return e.onAPISelect(i,-1)}}},[s("ep-store-more",[s("ep-store-more-item",{nativeOn:{click:function(t){return e.onAPIDelete(i,t)}}},[e._v("删除")]),s("ep-store-more-item",{nativeOn:{click:function(t){return e.onAPICopy(i,t)}}},[e._v("复制")])],1),s("p",{staticClass:"ep-store-dict-api-name"},[e._v(e._s(t.method)+" "+e._s(t.name))]),s("p",{staticClass:"ep-store-dict-api-url"},[e._v(e._s(t.url))])],1)}),s("div",{staticClass:"ep-store-dict-btns"},[s("Button",{attrs:{type:"ghost",size:"small"},on:{click:e.onNewAPI}},[e._v("+ 添加API")])],1)],2),e._l(e.dicts,function(t,i){return s("div",{key:t.name,staticClass:"ep-store-dict-item",attrs:{title:t.url}},[s("div",{staticClass:"ep-store-dict-info",class:e.getDictClass(i),on:{click:function(t){return e.onDictSelect(i)}}},[s("ep-store-more",[s("ep-store-more-item",{nativeOn:{click:function(t){return e.onDictToggle(i,t)}}},[e._v("收展")]),s("ep-store-more-item",{nativeOn:{click:function(t){return e.onDictDelete(i,t)}}},[e._v("删除")]),s("ep-store-more-item",{nativeOn:{click:function(t){return e.onDictCopy(i,t)}}},[e._v("复制")])],1),s("p",{staticClass:"ep-store-dict-name"},[e._v(e._s(t.method)+" "+e._s(t.name))]),s("p",{staticClass:"ep-store-dict-url"},[e._v(e._s(t.url))])],1),e._l(t.data,function(a,r){return s("div",{key:t.name+a.name,staticClass:"ep-store-dict-api",class:e.getAPIClass(r,i),on:{click:function(t){return e.onAPISelect(r,i)}}},[s("p",{staticClass:"ep-store-dict-api-name"},[e._v(e._s(a.method)+" "+e._s(a.name))]),s("p",{staticClass:"ep-store-dict-api-url"},[e._v(e._s(a.url))])])})],2)})],2)])};V._withStripped=!0;var N=function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"ep-store-more"},[t("div",{staticClass:"ep-store-more-title"},[t("div",{staticClass:"ep-store-more-text"},[this._v("...")]),t("div",{staticClass:"ep-store-more-content"},[this._t("default")],2)])])};N._withStripped=!0;var W=d({},N,[],!1,null,null,null);W.options.__file="src/panel/store/components/more.vue";var q=W.exports,G=function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"ep-store-more-item"},[this._t("default")],2)};G._withStripped=!0;var M=d({},G,[],!1,null,null,null);function H(e,t){if(null==e)return{};var s,i,a=function(e,t){if(null==e)return{};var s,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)s=r[i],t.indexOf(s)>=0||(a[s]=e[s]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)s=r[i],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}M.options.__file="src/panel/store/components/more-item.vue";var J=d({components:{EpStoreMore:q,EpStoreMoreItem:M.exports},props:{store:{type:Object,default:()=>({state:{}})}},data:()=>({dict:{name:"",header:[],body:"",query:[],params:[]},api:{name:"",header:[],body:"",query:[],params:[]}}),computed:{current(){return this.store.getStore().current},dicts(){return this.store.getStore().dicts},apis(){return this.store.getStore().apis},config(){return this.current[this.current.type]||{}}},methods:{onDictToggle(e,t){t.stopPropagation()},onDictDelete(e,t){t.stopPropagation(),this.store.deleteDict(e)},onDictCopy(e,t){t.stopPropagation(),this.store.copyDict(e)},onAPIDelete(e,t){t.stopPropagation(),this.store.deleteAPI(e)},onAPICopy(e,t){t.stopPropagation(),this.store.copyAPI(e)},getDictClass(e){var{type:t,dict:s}=this.current;return{"ep-store-dict-active":"dict"===t&&s.index===e}},getAPIClass(e,t){var{type:s,api:i,dict:a}=this.current;return{"ep-store-dict-api-active":"api"===s&&i.index===e&&a.index===t}},onDictSelect(e){var t=this.dicts[e],{data:s,source:a}=t,r=H(t,["data","source"]),o=Object.assign(i.helper.jsonClone(r),{data:[],source:[]}),{header:n,body:l,query:c,params:p}=o;o.header=i.helper.jsonClone(n),o.body=l,o.query=i.helper.jsonClone(c),o.params=i.helper.jsonClone(p),this.store.selectDict(o,e,"update")},onAPISelect(e,t){var s=this.apis[e];t>-1&&(s=this.dicts[t].data[e]);var{data:a,source:r}=s,o=H(s,["data","source"]),n=Object.assign(i.helper.jsonClone(o),{data:[],source:[]}),{header:l,body:c,query:p,params:d}=n;n.header=l||[],n.body=c,n.query=p||[],n.params=d||[],this.store.selectAPI(n,e,t)},onNewDict(){var e={name:"",url:"",method:"GET",header:[],body:{},params:[],query:[],adapter:""};e.body=JSON.stringify(e.body),this.store.selectDict(e,-1,"create")},onNewAPI(){var e={name:"",url:"",method:"GET",header:[],body:{},params:[],query:[],adapter:""};e.body=JSON.stringify(e.body),this.store.selectAPI(e,-1,-1)}}},V,[],!1,null,null,null);J.options.__file="src/panel/store/index.vue";var U=J.exports,K=function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"ep-store-setting"},[this.visible?t("store-form",{attrs:{store:this.store}}):t("div",{staticClass:"ep-store-setting-placeholder"},[this._v("请选择字典列表或"),t("span",{staticClass:"ep-store-setting-create",on:{click:this.onAddDict}},[this._v("创建")]),t("span",[this._v("字典")])])],1)};K._withStripped=!0;var Z=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Form",{ref:"setting",attrs:{model:e.configValue,rules:e.rules}},[s("Row",[s("Col",{attrs:{span:"6"}},[s("FormItem",{attrs:{label:"名称",prop:"name","label-width":60}},[s("Input",{attrs:{type:"text",placeholder:"英文、数字、下划线、中划线",disabled:!e.editable},model:{value:e.configValue.name,callback:function(t){e.$set(e.configValue,"name",t)},expression:"configValue.name"}})],1)],1),s("Col",{attrs:{span:"12",offset:"1"}},[s("FormItem",{attrs:{prop:"url","label-width":0}},[s("Input",{attrs:{type:"text",placeholder:"英文、数字、下划线、中划线",disabled:!e.editable},model:{value:e.configValue.url,callback:function(t){e.$set(e.configValue,"url",t)},expression:"configValue.url"}},[s("Select",{staticStyle:{width:"80px"},attrs:{slot:"prepend",disabled:!e.editable},slot:"prepend",model:{value:e.configValue.method,callback:function(t){e.$set(e.configValue,"method",t)},expression:"configValue.method"}},e._l(e.methods,function(t){return s("Option",{key:t,attrs:{value:t}},[e._v(e._s(t))])}),1)],1)],1)],1),s("Col",{attrs:{span:"5"}},[s("FormItem",[s("Button",{staticStyle:{"margin-right":"16px"},attrs:{type:"primary"},on:{click:e.onTest}},[e._v("测试")]),e.editable?s("Button",{on:{click:e.onSave}},[e._v("保存")]):e._e()],1)],1)],1),s("Tabs",{staticStyle:{"margin-bottom":"16px"},attrs:{size:"small",value:"query"}},[s("TabPane",{attrs:{label:"Query",name:"query"}},[s("EpKeyValue",{attrs:{list:e.configValue.query},on:{"on-add":function(t){for(var s=arguments.length,i=Array(s);s--;)i[s]=arguments[s];return e.headerPropAdd.apply(void 0,["query"].concat(i))},"on-delete":function(t){for(var s=arguments.length,i=Array(s);s--;)i[s]=arguments[s];return e.headerPropDelete.apply(void 0,["query"].concat(i))}}})],1),s("TabPane",{attrs:{label:"Header",name:"header"}},[s("EpKeyValue",{attrs:{list:e.configValue.header},on:{"on-add":function(t){for(var s=arguments.length,i=Array(s);s--;)i[s]=arguments[s];return e.headerPropAdd.apply(void 0,["header"].concat(i))},"on-delete":function(t){for(var s=arguments.length,i=Array(s);s--;)i[s]=arguments[s];return e.headerPropDelete.apply(void 0,["header"].concat(i))}}})],1),s("TabPane",{attrs:{label:"Body",name:"body"}},[s("Input",{attrs:{type:"textarea",placeholder:"JSON格式",autosize:{minRows:6}},model:{value:e.configValue.body,callback:function(t){e.$set(e.configValue,"body",t)},expression:"configValue.body"}})],1),s("TabPane",{attrs:{label:"Params",name:"params"}},[s("EpKeyValue",{attrs:{list:e.configValue.params},on:{"on-add":function(t){for(var s=arguments.length,i=Array(s);s--;)i[s]=arguments[s];return e.headerPropAdd.apply(void 0,["params"].concat(i))},"on-delete":function(t){for(var s=arguments.length,i=Array(s);s--;)i[s]=arguments[s];return e.headerPropDelete.apply(void 0,["params"].concat(i))}}})],1),s("TabPane",{attrs:{label:"Script",name:"script"}},[s("Input",{attrs:{type:"textarea",placeholder:"请求返回转换脚本，必须return",autosize:{minRows:6}},model:{value:e.configValue.adapter,callback:function(t){e.$set(e.configValue,"adapter",t)},expression:"configValue.adapter"}})],1)],1),s("h4",[e._v("响应")]),s("Tabs",{attrs:{size:"small",value:"format"}},[s("TabPane",{attrs:{label:"Format",name:"format"}},[s("ep-code-editor",{directives:[{name:"show",rawName:"v-show",value:e.format,expression:"format"}],attrs:{value:e.format}})],1),s("TabPane",{attrs:{label:"Header"}},[s("ep-code-editor",{directives:[{name:"show",rawName:"v-show",value:e.response.header,expression:"response.header"}],attrs:{value:e.response.header}})],1)],1)],1)};Z._withStripped=!0;var X=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("Row",{staticStyle:{"border-bottom":"1px solid #ddd","padding-bottom":"6px","margin-bottom":"6px"},attrs:{gutter:16}},[s("Col",{attrs:{span:"6"}},[e._v("key")]),s("Col",{attrs:{span:"6"}},[e._v("value")]),s("Col",{attrs:{span:"6"}},[e._v("描述")]),s("Col",{attrs:{span:"6"}},[e._v("操作")])],1),e._l(e.list,function(t,i){return s("Row",{key:i,staticStyle:{"margin-bottom":"6px"},attrs:{gutter:16}},[s("Col",{attrs:{span:"6"}},[s("Input",{attrs:{size:"small"},model:{value:t.key,callback:function(s){e.$set(t,"key",s)},expression:"item.key"}})],1),s("Col",{attrs:{span:"6"}},[s("Input",{attrs:{size:"small"},model:{value:t.value,callback:function(s){e.$set(t,"value",s)},expression:"item.value"}})],1),s("Col",{attrs:{span:"6"}},[s("Input",{attrs:{size:"small"},model:{value:t.description,callback:function(s){e.$set(t,"description",s)},expression:"item.description"}})],1),s("Col",{attrs:{span:"6"}},[s("Button",{staticStyle:{"margin-right":"6px"},attrs:{type:"dashed",size:"small"},on:{click:function(t){return e.onAdd(i)}}},[e._v("+")]),s("Button",{attrs:{type:"dashed",size:"small"},on:{click:function(t){return e.onDelete(i)}}},[e._v("-")])],1)],1)}),s("Row",[s("Col",{staticStyle:{"text-align":"center"},attrs:{span:"24"}},[s("Button",{staticStyle:{width:"100px"},attrs:{type:"dashed"},on:{click:function(t){return e.onAdd(e.list.length-1)}}},[e._v("+ 添加")])],1)],1)],2)};X._withStripped=!0;var Q=d({name:"EpKeyValue",props:{list:{type:Array,default:()=>[]}},methods:{onAdd(e){this.$emit("on-add",e)},onDelete(e){this.$emit("on-delete",e)}}},X,[],!1,null,null,null);Q.options.__file="src/panel/store/components/key-value.vue";var Y=d({components:{EpCodeEditor:x,EpKeyValue:Q.exports},props:{store:{type:Object,default:()=>({state:{}})}},data(){return{format:"",response:{header:""},methods:["GET","POST","PUT","DELETE"],rules:{name:[{required:!0,message:"必填"}],url:[{required:!0,message:"必填"}],method:[{required:!0,message:"必填"}],header:[{required:!1}],body:[{validator:this.validateJSON,trigger:"blur"}],params:[{required:!1}],query:[{required:!1}],adapter:[{required:!1}]}}},computed:{current(){return this.store.getStore().current},configValue(){return(this.current[this.current.type]||{}).value||{}},editable(){var{type:e,dict:t}=this.current;return!("api"===e&&t.index>-1)}},methods:{headerPropAdd(e,t){var s=this.current[this.current.type].value;s&&s[e].splice(t+1,0,{})},headerPropDelete(e,t){var s=this.current[this.current.type].value;s&&s[e].splice(t,1)},validateJSON(e,t,s){if(!t)return s();try{JSON.parse(t),s()}catch(e){s(new Error("format error!"))}},parseForm(){var e=Object.assign({},this.configValue);return e.header=i.helper.jsonClone(e.header||"[]"),e.params=i.helper.jsonClone(e.params||"[]"),e.query=i.helper.jsonClone(e.query||"[]"),e},onSave(){this.$refs.setting.validate(e=>{if(e){var{type:t}=this.current,{action:s,index:i}=this.current[t]||{},a=this.parseForm(),r={dict:{create:["addDict",[a]],update:["updateDict",[a,i]]},api:{create:["addAPI",[a]],update:["updateAPI",[a,i]]}};if(!(t in r))return;if(!(s in r[t]))return;var o=r[t][s];this.store[o[0]](...o[1])}else console.log("error:",this.configValue)})},onTest(){this.$refs.setting.validate(e=>{if(e){var t=new i.API(i.helper.jsonClone(this.parseForm()));t.getData().then(e=>{this.format=t.format,this.response.header=JSON.stringify(this.array2object(t.response.header),null,2)}).catch(e=>{this.format="",this.response.header="",console.error("fetch error:",e)})}else console.error("validate error:",this.configValue)})},array2object(){var e={};return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach(t=>{e[t.key]=t.value}),e}}},Z,[],!1,null,null,null);Y.options.__file="src/panel/store/form.vue";var ee=d({components:{StoreForm:Y.exports},props:{store:{type:Object,default:()=>({state:{}})}},computed:{current(){return this.store.getStore().current},visible(){var{type:e}=this.current,{index:t,action:s}=this.current[e]||{};return"create"===s||t>-1}},methods:{onAddDict(){var e={name:"",url:"",method:"GET",header:[],body:{},params:[],query:[],adapter:""};e.body=JSON.stringify(e.body),this.store.selectDict(e,-1,"create")}}},K,[],!1,null,null,null);ee.options.__file="src/panel/store/setting.vue";var te=ee.exports,se=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Collapse",{staticClass:"ivu-collapse-simple",attrs:{value:e.widgets[0]&&e.widgets[0].key,simple:""}},e._l(e.widgets,function(t){return s("Panel",{key:t.key,attrs:{name:t.key}},[e._v(e._s(t.title)),s("template",{slot:"content"},[s("div",{staticClass:"ep-clearfix"},e._l(t.widgets,function(t){return s("div",{key:t.Schema.widget,staticClass:"ep-tool-item",attrs:{animation:200},on:{click:function(s){return e.addWidget(t)}}},[s("div",{staticClass:"ep-tool-item-inner"},[s("span",[e._v(e._s(t.Schema.title))])]),t.Schema.preview?s("div",{staticClass:"ep-tool-item-hover"},[s("img",{attrs:{src:t.Schema.preview}})]):e._e()])}),0)])],2)}),1)};se._withStripped=!0;var{isFunction:ie}=i.helper,ae=d({props:{widgets:{type:Array,default:()=>[]},add:{type:Function,default:()=>()=>{}}},data:()=>({}),methods:{addWidget(e){e&&ie(e.Schema)&&this.$emit("on-add",e.Schema.widget)}}},se,[],!1,null,null,null);ae.options.__file="src/panel/tool/index.vue";var re=ae.exports,oe=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ep-schema"},[s("ep-code-editor",{attrs:{value:JSON.stringify(e.value,null,2),lang:"json"}},[s("template",{slot:"bar"},[s("div",{staticClass:"ep-schema-btns"},[s("Button",{staticStyle:{"margin-right":"10px"},attrs:{size:"small",title:"点击导入"},nativeOn:{click:function(t){return e.onImportShow(t)}}},[s("i",{staticClass:"ep-icon ep-icon-code"},[e._v(" ")]),s("span",[e._v("导入")])]),s("Button",{attrs:{size:"small",title:"点击复制"},nativeOn:{click:function(t){return e.onCopy(t)}}},[s("i",{staticClass:"ep-icon ep-icon-copy"},[e._v(" ")]),s("span",[e._v("复制")])])],1)])],2),s("Modal",{attrs:{title:"导入schema",width:600,transfer:!0},on:{"on-visible-change":e.onModalChange},model:{value:e.importModal.visible,callback:function(t){e.$set(e.importModal,"visible",t)},expression:"importModal.visible"}},[s("Input",{class:{"ivu-form-item-error":e.importModal.error},attrs:{type:"textarea",rows:10,placeholder:'请输入schema数据，如：\n{\n  "widget": "grid",\n  "children": [],\n  ...\n}'},model:{value:e.importModal.schema,callback:function(t){e.$set(e.importModal,"schema",t)},expression:"importModal.schema"}}),e.importModal.error?s("div",{staticClass:"ivu-form-item-error-tip",staticStyle:{position:"static"}},[e._v("schema格式解析错误")]):e._e(),s("template",{slot:"footer"},[s("Button",{attrs:{size:"small"},on:{click:e.onImportHide}},[e._v("取消")]),s("Button",{attrs:{size:"small",type:"primary"},on:{click:e.onImport}},[e._v("导入")])],1)],2)],1)};oe._withStripped=!0;var{copy:ne}=i.helper,le=d({components:{EpCodeEditor:x},props:{store:{type:Object,default:()=>({state:{}})},value:{type:Object,default:()=>({})}},data:()=>({importModal:{visible:!1,error:!1,schema:""}}),methods:{onImportShow(){this.importModal.visible=!0},onImportHide(){this.importModal.visible=!1},onImport(){var e="";try{e=JSON.parse(this.importModal.schema),this.store.initRootSchema(e),this.store.deselectWidget(),o.Message.success({content:"导入成功",duration:2}),this.onImportHide()}catch(e){this.importModal.error=!0}},onModalChange(e){this.importModal.schema="",this.importModal.error=!1},onCopy(){var e=JSON.stringify(this.store.getSchema(),null,2);e=this.$root.$options.extension.callPlugin("schema","copy",e)||e,ne(e).then(()=>{o.Message.success({content:"复制成功",duration:2})},()=>{o.Message.error({content:"复制失败",duration:2})})}}},oe,[],!1,null,null,null);le.options.__file="src/panel/schema/index.vue";var ce=le.exports,pe=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ep-logic"},[s("h3",{staticClass:"ep-logic-title"},[e._v("逻辑配置表")]),s("div",{staticClass:"ep-logic-btns"},[s("Button",{staticClass:"ep-logic-btn-value",attrs:{size:e.size},on:{click:function(t){return e.addLogic("value")}}},[e._v("+ 值逻辑")]),s("Button",{staticClass:"ep-logic-btn-event",attrs:{size:e.size},on:{click:function(t){return e.addLogic("event")}}},[e._v("+ 事件逻辑")])],1),s("table",{staticClass:"ep-logic-table"},[e._m(0),s("tbody",e._l(e.schema.logics,function(t,i){return s("tr",{key:i},[s("td",[e._v(e._s(e.map.logic[t.type].title))]),s("td",[e._v(e._s(e.getSchemaText(t.key)))]),s("td",[e._v(e._s(e.map.logic[t.type].map[t.action].value)+" "+e._s(e.getRelation(t)))]),s("td",[e._v(e._s("value"===t.type?t.value:"--"))]),s("td",["prop"===t.trigger?e._l(t.effects,function(t,i){return s("Row",{key:i,staticClass:"ep-logic-action"},[s("Col",{staticClass:"ep-logic-controlled",attrs:{span:"12"}},[e._v(e._s(e.getSchemaText(t.key)))]),s("Col",{attrs:{span:"12"}},e._l(t.properties,function(t,i){return s("span",{key:i},[s("Tag",[e._v(e._s(e.map.prop[t.key].text)+": "+e._s(e.map.prop[t.key].option[t.value?"open":"close"]))])],1)}),0)],1)}):[s("pre",[e._v("script: "+e._s(t.script.substr(0,20))+" ...")])]],2),s("td",[s("Button",{staticStyle:{"margin-right":"6px"},attrs:{size:"small",type:"ghost"},on:{click:function(s){return e.onEdit(t,i)}}},[s("i",{staticClass:"ep-icon ep-icon-edit"},[e._v(" ")]),s("span",[e._v("编辑")])]),s("Button",{attrs:{size:"small",type:"ghost"},on:{click:function(t){return e.onDelete(i)}}},[s("i",{staticClass:"ep-icon ep-icon-trash"},[e._v(" ")]),s("span",[e._v("删除")])])],1)])}),0)]),e.schema.logics&&0!==e.schema.logics.length?e._e():s("div",{staticClass:"ep-logic-table-empty"},[e._v("暂无逻辑配置")]),s("Modal",{attrs:{title:e.modal.title,loading:e.modal.loading},on:{"on-ok":e.onModalOk},model:{value:e.modal.visible,callback:function(t){e.$set(e.modal,"visible",t)},expression:"modal.visible"}},[s("logic-form",{attrs:{logic:e.modal.logic,store:e.store,map:e.map},on:{"on-change":e.onLogicChange,"on-add-effect":e.onAddEffect}})],1)],1)};pe._withStripped=!0;var de=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ep-logic-form"},[s("Form",{attrs:{"label-width":100}},[s("FormItem",{attrs:{label:"主控widget"}},[s("Select",{model:{value:e.curLogic.key,callback:function(t){e.$set(e.curLogic,"key",t)},expression:"curLogic.key"}},e._l(e.logicSchemaList[e.curLogic.type],function(t){return s("Option",{key:t.key,attrs:{value:t.key}},[e._v(e._s(e.getSchemaText(t.key)))])}),1)],1),s("FormItem",{attrs:{label:e.map.type[e.curLogic.type]||"关系"}},[s("Select",{model:{value:e.curLogic.action,callback:function(t){e.$set(e.curLogic,"action",t)},expression:"curLogic.action"}},e._l(e.getLogicOption(e.curLogic),function(t){return s("Option",{key:t,attrs:{value:t}},[e._v(e._s(e.getRelationText(e.curLogic.type,t)))])}),1)],1),"value"===e.curLogic.type?s("FormItem",{attrs:{label:"值"}},[s("Input",{attrs:{placeholder:"请输入值"},model:{value:e.curLogic.value,callback:function(t){e.$set(e.curLogic,"value",t)},expression:"curLogic.value"}})],1):e._e(),"value"!==e.curLogic.type||"><"!==e.curLogic.action&&"<>"!==e.curLogic.action?e._e():s("FormItem",{attrs:{label:"值类型"}},[s("RadioGroup",{model:{value:e.curLogic.relation,callback:function(t){e.$set(e.curLogic,"relation",t)},expression:"curLogic.relation"}},[s("Radio",{attrs:{label:"and"}},[e._v("且")]),s("Radio",{attrs:{label:"or"}},[e._v("或")])],1)],1),s("FormItem",{attrs:{label:"变更类型"}},[s("RadioGroup",{model:{value:e.curLogic.trigger,callback:function(t){e.$set(e.curLogic,"trigger",t)},expression:"curLogic.trigger"}},e._l(e.effectTypes,function(t){return s("Radio",{key:t.key,attrs:{label:t.key}},[e._v(e._s(t.value))])}),1)],1),"script"===e.curLogic.trigger?[s("FormItem",{attrs:{label:"脚本"}},[s("Input",{attrs:{type:"textarea",autosize:{minRows:3,maxRows:8},placeholder:"自定义脚本，打印 ctx 看看"},model:{value:e.curLogic.script,callback:function(t){e.$set(e.curLogic,"script",t)},expression:"curLogic.script"}})],1)]:e._l(e.controlledWidgetEffects,function(t,i){return s("FormItem",{key:i,attrs:{label:"受控widget-"+(i+1)}},[s("Row",{staticClass:"ep-logic-controlled-border"},[s("Col",{attrs:{span:"20"}},[s("Select",{model:{value:e.controlledWidgetEffects[i].key,callback:function(t){e.$set(e.controlledWidgetEffects[i],"key",t)},expression:"controlledWidgetEffects[i].key"}},e._l(e.getUnControlledSchemaList(e.curLogic),function(t){return s("Option",{key:t.key,attrs:{value:t.key}},[e._v(e._s(e.getSchemaText(t.key)))])}),1),s("Row",e._l(t.properties,function(t){return s("Col",{key:t.key,attrs:{span:"12"}},[s("FormItem",{attrs:{label:e.map.prop[t.key].text,"label-width":80}},[s("i-switch",{model:{value:t.value,callback:function(s){e.$set(t,"value",s)},expression:"prop.value"}},[s("span",{attrs:{slot:"open"},slot:"open"},[e._v(e._s(e.map.prop[t.key].option.open))]),s("span",{attrs:{slot:"close"},slot:"close"},[e._v(e._s(e.map.prop[t.key].option.close))])])],1)],1)}),1)],1),s("Col",{attrs:{span:"4"}},[s("Button",{attrs:{type:"text",size:"small"},on:{click:e.onAddEffect}},[s("i",{staticClass:"ep-icon ep-icon-plus"})]),s("Button",{directives:[{name:"show",rawName:"v-show",value:e.controlledWidgetEffects.length>1,expression:"controlledWidgetEffects.length > 1"}],attrs:{type:"text",size:"small"},on:{click:function(t){return e.onRemoveEffect(i)}}},[s("i",{staticClass:"ep-icon ep-icon-minus"})])],1)],1)],1)})],2)],1)};de._withStripped=!0;var{isArray:ue}=i.helper,{Effect:he}=i.Logic,me=d({props:{logic:{type:Object,default:()=>({key:"",action:"",value:"",effects:[]})},map:{type:Object,default:()=>({logic:{},type:{},prop:{}})},store:{type:Object,default:()=>({state:{}})}},data(){return{curLogic:this.logic,effectTypes:[{key:"prop",value:"属性"},{key:"script",value:"脚本"}]}},computed:{flatSchemas(){return this.store.getFlatSchemas()},flatWidgets(){return this.store.getFlatWidgets()||{}},schemaList(){return Object.keys(this.flatSchemas).map(e=>this.flatSchemas[e])},logicSchemaList(){var{flatSchemas:e,flatWidgets:t}=this,s={event:[],value:[]},i=(e,s,i)=>{var a=t[e.widget].Schema.logic||{};ue(a[s])&&a[s].length&&!e.container&&i[s].push(e)};for(var a in e){var r=e[a];i(r,"event",s),i(r,"value",s)}return s},controlledWidgetEffects(){return(this.curLogic.effects||[]).filter(e=>this.curLogic.key!==e.key)}},watch:{logic(e){this.curLogic=e},curLogic(e){this.$emit("on-change",e)}},methods:{getRelationText(e,t){return this.map.logic[e].map[t].value},getSchemaText(e){var t=this.flatSchemas[e]||{},s=t.label||"",i=t.option||{};return s.trim()||i.text||e},getLogicOption(e){var{key:t,type:s}=e,i=[],{flatWidgets:a}=this,r=a[(this.schemaList.filter(e=>e.key===t)[0]||{}).widget];return r&&r.Schema&&s in r.Schema.logic&&(i=r.Schema.logic[s]),i},getUnControlledSchemaList(e){var{key:t,type:s}=e;return this.schemaList.filter(e=>e.key!==t)},onAddEffect(){var e=new he;this.$emit("on-add-effect",e)},onRemoveEffect(e){this.curLogic.effects.splice(e,1),this.$emit("on-remove-effect",e)}}},de,[],!1,null,null,null);me.options.__file="src/panel/logic/LogicForm.vue";var ve=me.exports,ge={logic:(new i.Logic).map,type:{value:"当",event:"发生"},prop:{hidden:{text:"隐藏",option:{open:"是",close:"否"}},disabled:{text:"禁用",option:{open:"是",close:"否"}}}},fe=d({components:{LogicForm:ve},props:{store:{type:Object,default:()=>({state:{}})}},data:()=>({size:"small",map:ge,modal:{title:"逻辑设置",visible:!1,loading:!1,index:-1,logic:{type:"",key:"",action:"",value:"",trigger:"prop",relation:"or",script:"",effects:[]}}}),computed:{schema(){return this.store.getRootSchema()||{}},flatSchemas(){return this.store.getFlatSchemas()},flatWidgets(){return this.store.getFlatWidgets()||{}},schemaList(){return Object.keys(this.flatSchemas).map(e=>this.flatSchemas[e])}},methods:{getRelation(e){var t="",{action:s,relation:i}=e,a={or:"或",and:"且"};return["<>","><"].indexOf(s)>-1&&i in a&&(t="("+a[i]+")"),t},getSchemaText(e){var t=this.flatSchemas[e]||{},s=t.label||"",i=t.option||{};return s.trim()||i.text||e},addLogic(e){if(this.map.logic[e]){this.modal.visible=!0;var t=this.map.logic[e].get();this.modal.logic=t}},onDelete(e){this.store.removeLogic(e)},onEdit(e,t){this.modal.visible=!0,this.modal.logic=JSON.parse(JSON.stringify(e)),this.modal.index=t},onModalOk(){var{type:e,key:t,action:s,effects:i,trigger:a}=this.modal.logic,{index:r,logic:o}=this.modal;if(e&&t&&s){if("prop"===a&&!function(e){return Array.isArray(e)&&e.filter(e=>e.key&&(e=>e.length>0)(e.properties)).length===e.length}(i))return;r>-1?(this.store.updateLogic(r,o),this.modal.index=-1):this.store.addLogic(o)}},onLogicChange(e){this.modal.logic=e},onAddEffect(e){this.modal.logic.effects.push(e)}}},pe,[function(){var e=this.$createElement,t=this._self._c||e;return t("thead",[t("tr",[t("th",[this._v("类型")]),t("th",[this._v("主控widget")]),t("th",[this._v("行为")]),t("th",[this._v("值")]),t("th",[this._v("受控widget")]),t("th",[this._v("操作")])])])}],!1,null,null,null);fe.options.__file="src/panel/logic/index.vue";var ye=fe.exports,be=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ep-tabs",{attrs:{value:e.tab,tabs:e.widgetSettings},on:{"on-click":e.onChangeTab}},e._l(e.widgetSettings,function(t,i){return s("ep-tabs-pane",{directives:[{name:"show",rawName:"v-show",value:t.key===e.tab,expression:"item.key === tab"}],key:i},[s("div",{staticClass:"ep-setting-prop"},[e.isVue(t)?s(t.component,{tag:"component",attrs:{store:e.store,schema:e.selectedSchema,root:"global"===t.key}}):e._e(),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.isVue(t),expression:"!isVue(item)"}],ref:"settings",refInFor:!0})],1)])}),1)};be._withStripped=!0;var _e=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Form",{attrs:{"label-width":80}},[s("FormItem",{attrs:{label:"标题"}},[s("Input",{attrs:{size:e.size,placeholder:"给页面起个名字吧"},model:{value:e.rootSchema.title,callback:function(t){e.$set(e.rootSchema,"title",t)},expression:"rootSchema.title"}})],1),s("FormItem",{attrs:{label:"描述"}},[s("Input",{attrs:{size:e.size,type:"textarea",placeholder:"写点描述吧"},model:{value:e.rootSchema.description,callback:function(t){e.$set(e.rootSchema,"description",t)},expression:"rootSchema.description"}})],1),s("FormItem",{attrs:{label:"label宽(px)"}},[s("InputNumber",{attrs:{size:e.size,min:0,step:1},model:{value:e.rootSchema.label.width,callback:function(t){e.$set(e.rootSchema.label,"width",t)},expression:"rootSchema.label.width"}})],1),s("FormItem",{attrs:{label:"label位置"}},[s("RadioGroup",{attrs:{size:e.size},on:{"on-change":e.onPositionChange},model:{value:e.rootSchema.label.position,callback:function(t){e.$set(e.rootSchema.label,"position",t)},expression:"rootSchema.label.position"}},[s("Radio",{attrs:{label:"top"}},[e._v("上")]),s("Radio",{attrs:{label:"left"}},[e._v("左")]),s("Radio",{attrs:{label:"right"}},[e._v("右")])],1)],1),s("FormItem",{attrs:{label:"尺寸"}},[s("RadioGroup",{attrs:{size:e.size},model:{value:e.rootSchema.size,callback:function(t){e.$set(e.rootSchema,"size",t)},expression:"rootSchema.size"}},[s("Radio",{attrs:{label:"small"}},[e._v("小")]),s("Radio",{attrs:{label:"default"}},[e._v("默认")]),s("Radio",{attrs:{label:"large"}},[e._v("大")])],1)],1),s("ep-style-setting",{attrs:{schema:e.rootSchema,store:e.store,root:!0}},[s("span",{attrs:{slot:"display"},slot:"display"})]),e._t("default")],2)};_e._withStripped=!0;var we=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.schema.style?s("Form",{staticClass:"ep-setting-style"},[e._t("before"),e.$slots.display?[e._t("display")]:s("FormItem",{attrs:{label:"展示类型"}},[s("RadioGroup",{attrs:{size:"small"},model:{value:e.schema.style.display,callback:function(t){e.$set(e.schema.style,"display",t)},expression:"schema.style.display"}},[s("Radio",{attrs:{label:"block"}},[e._v("块元素")]),s("Radio",{attrs:{label:"inline-block"}},[e._v("行内块元素")])],1)],1),e.$slots.font?[e._t("font")]:s("ep-setting-block",{attrs:{title:"文字配置"}},[s("Row",["string"==typeof e.schema.style.color?s("Col",{attrs:{span:"24"}},[s("Row",[s("Col",{attrs:{span:"10"}},[s("FormItem",{attrs:{label:"文字色","label-width":60}},[s("ColorPicker",{staticClass:"ep-style-color-picker",attrs:{size:"small",alpha:!0},model:{value:e.schema.style.color,callback:function(t){e.$set(e.schema.style,"color",t)},expression:"schema.style.color"}})],1)],1),s("Col",{attrs:{span:"14"}},[s("FormItem",{attrs:{label:"RGB值","label-width":60}},[s("Input",{attrs:{size:"small"},model:{value:e.schema.style.color,callback:function(t){e.$set(e.schema.style,"color",t)},expression:"schema.style.color"}})],1)],1)],1)],1):e._e(),s("Col",{attrs:{span:"24"}},[s("FormItem",{attrs:{label:"粗细","label-width":60}},[s("RadioGroup",{attrs:{size:"small"},model:{value:e.schema.style["font-weight"],callback:function(t){e.$set(e.schema.style,"font-weight",t)},expression:'schema.style["font-weight"]'}},[s("Radio",{attrs:{label:"100"}},[e._v("最细")]),s("Radio",{attrs:{label:"200"}},[e._v("细")]),s("Radio",{attrs:{label:"400"}},[e._v("正常")]),s("Radio",{attrs:{label:"700"}},[e._v("粗")])],1)],1)],1),s("Col",{attrs:{span:"24"}},[s("FormItem",{attrs:{label:"对齐","label-width":60}},[s("RadioGroup",{attrs:{size:"small"},model:{value:e.schema.style["text-align"],callback:function(t){e.$set(e.schema.style,"text-align",t)},expression:'schema.style["text-align"]'}},[s("Radio",{attrs:{label:"left"}},[e._v("左")]),s("Radio",{attrs:{label:"center"}},[e._v("中")]),s("Radio",{attrs:{label:"right"}},[e._v("右")])],1)],1)],1)],1)],1),e.$slots.area?[e._t("area")]:s("ep-setting-block",{attrs:{title:"宽高配置"}},[s("Row",[s("Col",{attrs:{span:"12"}},[s("FormItem",{attrs:{label:"宽度","label-width":60}},[s("Input",{attrs:{size:"small"},model:{value:e.schema.style.width,callback:function(t){e.$set(e.schema.style,"width",t)},expression:"schema.style.width"}})],1)],1),s("Col",{attrs:{span:"12"}},[s("FormItem",{attrs:{label:"高度","label-width":60}},[s("Input",{attrs:{size:"small"},model:{value:e.schema.style.height,callback:function(t){e.$set(e.schema.style,"height",t)},expression:"schema.style.height"}})],1)],1),s("Col",{attrs:{span:"12"}},[s("FormItem",{attrs:{label:"最大宽","label-width":60}},[s("Input",{attrs:{size:"small"},model:{value:e.schema.style["max-width"],callback:function(t){e.$set(e.schema.style,"max-width",t)},expression:'schema.style["max-width"]'}})],1)],1),s("Col",{attrs:{span:"12"}},[s("FormItem",{attrs:{label:"最大高","label-width":60}},[s("Input",{attrs:{size:"small"},model:{value:e.schema.style["max-height"],callback:function(t){e.$set(e.schema.style,"max-height",t)},expression:'schema.style["max-height"]'}})],1)],1),s("Col",{attrs:{span:"12"}},[s("FormItem",{attrs:{label:"最小宽","label-width":60}},[s("Input",{attrs:{size:"small"},model:{value:e.schema.style["min-width"],callback:function(t){e.$set(e.schema.style,"min-width",t)},expression:'schema.style["min-width"]'}})],1)],1),s("Col",{attrs:{span:"12"}},[s("FormItem",{attrs:{label:"最小高","label-width":60}},[s("Input",{attrs:{size:"small"},model:{value:e.schema.style["min-height"],callback:function(t){e.$set(e.schema.style,"min-height",t)},expression:'schema.style["min-height"]'}})],1)],1)],1)],1),e.$slots.margin?[e._t("margin")]:s("ep-setting-bounding",{attrs:{title:"外边距",type:"margin",styles:e.schema.style}}),e.$slots.padding?[e._t("padding")]:s("ep-setting-bounding",{attrs:{title:"内边距",type:"padding",styles:e.schema.style}}),e.$slots.position?s("ep-setting-bounding",{attrs:{title:"位置",type:"position",styles:e.schema.style}},[s("template",{slot:"before"},[s("FormItem",{attrs:{label:"类型","label-width":60}},[s("RadioGroup",{attrs:{size:"small"},model:{value:e.schema.style.position,callback:function(t){e.$set(e.schema.style,"position",t)},expression:"schema.style.position"}},[s("Radio",{attrs:{label:"relative"}},[e._v("默认")]),s("Radio",{attrs:{label:"absolute"}},[e._v("绝对")]),s("Radio",{attrs:{label:"fixed"}},[e._v("固定")]),s("Radio",{attrs:{label:"sticky"}},[e._v("粘性")])],1)],1),s("FormItem",{attrs:{label:"层级","label-width":60}},[s("Input",{attrs:{size:"small",placeholder:"请输入整数"},model:{value:e.schema.style["z-index"],callback:function(t){e.$set(e.schema.style,"z-index",t)},expression:'schema.style["z-index"]'}})],1)],1)],2):[e._t("position")],e.schema.style.container?s("ep-setting-background",{attrs:{title:"背景设置",schema:e.schema,store:e.store,root:e.root}}):e._e(),e._t("default")],2):e._e()};we._withStripped=!0;var ke=d({components:{EpSettingBounding:g,EpSettingBlock:h,EpSettingBackground:w},props:{schema:{type:Object,default:()=>({style:{}})},root:{type:Boolean,default:!0},store:{type:Object,default:()=>({state:{}})}}},we,[],!1,null,null,null);ke.options.__file="src/panel/setting/style.vue";var Se=ke.exports,xe=d({components:{EpStyleSetting:Se},props:{store:{type:Object,default:()=>({state:{}})}},data:()=>({size:"small"}),computed:{rootSchema(){return this.store.getRootSchema()}},methods:{onPositionChange(e){var t="top"===e?0:80;this.rootSchema.label.width=t}}},_e,[],!1,null,null,null);xe.options.__file="src/panel/setting/form.vue";var Ce=xe.exports,{isArray:$e,isFunction:Pe,isPlainObject:Ie,isString:Oe}=i.helper,Re=[{key:"style",name:"样式",framework:"vue",component:Se},{key:"global",name:"页面",framework:"vue",component:Ce}],Ee=d({components:{FormSetting:Ce,EpPanel:j,EpTabs:F,EpTabsPane:D},props:{settings:{type:Array,default:()=>[]},store:{type:Object,default:()=>({types:{},state:{}})}},data:()=>({tab:"global",filterSettings:[],defaultSettings:[...Re]}),computed:{isSelected(){return this.store.isSelected()},settingWidget(){return this.store.getSettingWidget()},selectedSchema(){return this.store.getSelectedSchema()},widgetSettings(){return this.isSelected?this.filterSettings:this.defaultSettings}},watch:{selectedSchema(){this.selectedSettings()}},mounted(){this.selectedSettings()},methods:{isVue:e=>e&&("vue"===e.framework||Ie(e.component)),isReact:e=>e&&"react"===e.framework,onChangeTab(e,t){e&&e!==this.tab&&(this.tab=e,this.renderCurrentSetting(t))},selectedSettings(){var e=[...Re],t=[...this.settings],s=[];$e(this.settingWidget)?s=s.concat(this.settingWidget):Pe(this.settingWidget)?s.unshift({key:"prop",name:"属性",component:this.settingWidget}):Ie(this.settingWidget)&&s.unshift({key:"prop",name:"属性",framework:"vue",component:this.settingWidget});var i=[];i=[].concat(s,t,e),i=this.unique(i),this.isSelected?this.filterSettings=[...i]:this.defaultSettings=[...i],this.renderSettings()},renderCurrentSetting(e){this.$nextTick(()=>{var t=this.$refs.settings;if(t&&!(t.length<=0)){var s=t[e],i=this.widgetSettings[e];Pe(i.component)&&i.component({el:s,store:this.store})}})},renderSettings(){this.$nextTick(()=>{var e=this.$refs.settings;!e||e.length<=0||e.length!==this.widgetSettings.length||this.widgetSettings.forEach((t,s)=>{var a=e[s],{component:r}=t;this.isReact(t)?new i.render.ReactRender({el:a,store:this.store,component:r}):Pe(r)&&r({el:a,store:this.store})})})},unique(){var e={};return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).filter(t=>!(!t||!t.component)&&(!(!t.key||!Oe(t.key))&&(!(t.key in e)&&(e[t.key]=!0,!0))))}}},be,[],!1,null,null,null);Ee.options.__file="src/panel/setting/index.vue";var ze=Ee.exports,je=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ep-header-container"},[e.header.render?s("div",{ref:"header",staticClass:"ep-header",style:e.header.style||""}):s("div",{staticClass:"ep-header",style:e.header.style||""},[e.header.left&&e.header.left.render?s("div",{ref:"left",staticClass:"ep-header-left",style:(e.header.left||{}).style||""}):s("div",{staticClass:"ep-header-left",style:(e.header.left||{}).style||""},[e._v("Epage")]),e.header.center&&e.header.center.render?s("div",{ref:"center",staticClass:"ep-header-center",style:(e.header.center||{}).style||""}):s("div",{staticClass:"ep-header-center",style:(e.header.center||{}).style||""},[e.ready.pc&&e.ready.h5?s("RadioGroup",{attrs:{type:"button",size:"small"},on:{"on-change":e.onChangeView},model:{value:e.designView.view,callback:function(t){e.$set(e.designView,"view",t)},expression:"designView.view"}},[s("Radio",{attrs:{label:"pc"}},[e._v("PC")]),s("Radio",{attrs:{label:"h5"}},[e._v("H5")])],1):e._e()],1),e.header.right&&e.header.right.render?s("div",{ref:"right",staticClass:"ep-header-right",style:(e.header.right||{}).style||""}):s("div",{staticClass:"ep-header-right",style:(e.header.right||{}).style||""},[e.testProp("right","logic")?s("Button",{staticClass:"ep-header-right-item",attrs:{size:"small",type:"ghost"},on:{click:e.onShowLogic}},[e._v("logic")]):e._e(),e.testProp("right","schema")?s("Button",{staticClass:"ep-header-right-item",attrs:{size:"small",type:"ghost"},on:{click:e.onShowSchema}},[e._v("schema")]):e._e(),e.testProp("right","preview")?s("Button",{staticClass:"ep-header-right-item",attrs:{size:"small",type:"ghost"},on:{click:e.onPreview}},[e._v("预览")]):e._e(),e.testProp("right","help")?s("a",{staticClass:"ep-header-right-item",attrs:{href:"http://epage.didichuxing.com",target:"_blank"}},[s("i",{staticClass:"ep-icon ep-icon-help"}),s("span",[e._v(" 帮助")])]):e._e()],1)])])};je._withStripped=!0;var Le=d({props:{header:{type:Object,default:()=>({})},store:{type:Object,default:()=>({state:{}})},designView:{type:Object,default:()=>({view:"pc"})},ready:{type:Object,default:()=>({pc:!1,h5:!1})}},mounted(){this.header.render?this.renderRef(this,"header"):(this.renderRef(this.header,"left"),this.renderRef(this.header,"center"),this.renderRef(this.header,"right"))},methods:{testProp(e,t){var s=!0;if(!this.header)return s;this.header[e]&&(s=!1!==this.header[e][t]);return s},onChangeView(e){this.$emit("change-view",e)},onPreview(){this.$emit("preview")},onShowSchema(){this.$emit("show-schema")},onShowLogic(){this.$emit("show-logic")},onChangeLange(e){this.$emit("change-lang",e)},renderRef(e,t){if(e[t]&&"function"==typeof e[t].render){var s=this.$refs[t],i={$emit:this.$emit.bind(this)},{store:a}=this;e[t].render({el:s,store:a,ctx:i})}}}},je,[],!1,null,null,null);Le.options.__file="src/panel/header/index.vue";var Be=d({components:{EpPanel:j,EpStore:U,EpStoreSetting:te,EpTool:re,EpLogic:ye,EpSchema:ce,EpSetting:ze,EpHeader:Le.exports,EpH5Emulator:P,EpFullscreen:R},data:()=>({preview:{view:"",pc:null,h5:null},design:{view:"pc",pc:null,h5:null},ready:{pc:!1,h5:!1},schemaPanel:{visible:!1},logicPanel:{visible:!1},env:"production",panels:{preview:!0,logic:!0,schema:!0,header:{left:{},center:{},right:{}}},settings:[],nav:{list:[{key:"widget",value:"物料"},{key:"store",value:"仓库"}],active:"widget"},settingState:{fold:!1,text:"收起"}}),computed:{store(){return this.$root.$options.extension.store},widgets(){return this.store.getWidgets()},flatWidgets(){return this.store.getFlatWidgets()},rootSchema(){return this.store.getRootSchema()},selectedSchema(){return this.store.getSelectedSchema()}},beforeMount(){var e=this.$root.$options.extension||{};Object.assign(this.panels,e.panels),this.settings=e.settings,this.design.view=e.view||"pc",this.setReady()},mounted(){this.renderDesignView(this.design.view),this.store.updateTab("design")},methods:{setReady(){var e=this.$root.$options.extension||{},{pc:t,h5:s}=e,i=t&&t.widgets&&t.Render,a=s&&s.widgets&&s.Render;this.ready.pc=!!i,this.ready.h5=!!a},getIns(e){return(this.$root.$options.extension||{})[e]},onPreview(){this.renderPreview(this.design.view)},showSchemaPanel(){this.schemaPanel.visible=!0},closeSchemaPanel(){this.schemaPanel.visible=!1},showLogicPanel(){this.logicPanel.visible=!0},closeLogicPanel(){this.logicPanel.visible=!1},changePreview(e){this.renderPreview(e)},closePreview(){this.preview.view="";var{h5:e,pc:t}=this.preview;this.destoryRender(e),this.destoryRender(t)},destoryRender(e){e&&i.helper.isFunction(e.destroy)&&e.destroy()},renderView(e,t){if(e&&t){var s=this.$refs[t+"-"+e],a=this.store.getSchema(),{pc:r,h5:o}=this[t],n=this.$root.$options.extension,{setRender:l,callPlugin:c,Render:p,widgets:d,component:u}=n;if(this[t].view=e,i.helper.include(["pc","h5"],e))if(this.getIns(e)){var h=p||n[e].Render,m=d||n[e].widgets,v=u||n[e].component;if(h&&m&&m.length&&v){var g={el:s,mode:"edit"};"design"===t?(this.store.initWidgets(m),g.store=this.store):(g.schema=a,g.widgets=m),g.component=v,g.callPlugin=c,this[t][e]=new h(g),"design"===t&&l(this.design[e]),"pc"===e&&this.destoryRender(o),"h5"===e&&this.destoryRender(r)}}}},renderPreview(e){this.renderView(e,"preview")},renderDesignView(e){this.renderView(e,"design")},onUnfold(){var{fold:e}=this.settingState;this.settingState=e?{fold:!1,text:"收起"}:{fold:!0,text:"展开"}},onAddWidget(e){this.store.addWidget(e)}}},l,[],!1,null,null,null);Be.options.__file="src/index.vue";var Fe=Be.exports,Te=s(3),{isArray:Ae,isFunction:De,usePlugins:Ve,isPlainObject:Ne}=i.helper,We=e=>Object.assign({component:null,widgets:[],Render:null},e||{});class qe{constructor(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.el=e.el,this.panels=e.panels||{},this.settings=e.settings||[],this.plugins=e.plugins||[],this.pc=We(e.pc),this.h5=We(e.h5),this.env=e.env||"production",this.view=e.view||"pc",this.Render=e.Render,this.widgets=e.widgets,this.component=e.component,this.schema=e.schema,this.$$origin=null,this.$render=null,this.$hooks={life:{init:new i.hook.SyncHook,beforeCreate:new i.hook.SyncHook,created:new i.hook.SyncHook,beforeDestroy:new i.hook.SyncHook,destroyed:new i.hook.SyncHook},schema:{copy:new i.hook.SyncWaterfallHook},render:{init:new i.hook.SyncHook,beforeCreate:new i.hook.SyncHook,created:new i.hook.SyncHook,beforeDestroy:new i.hook.SyncHook,destroyed:new i.hook.SyncHook}},Ve(r.a,[Te,n.a]),this.$initPlugins(),this.callPlugin("life","init",{ctx:this}),this.store=new i.Store({Rule:e.Rule||i.Rule});var t=this.widgets||this[this.view]&&this[this.view].widgets||[];Ae(t)?(this.store.initWidgets(t),Ne(this.schema)&&this.store.initRootSchema(this.schema),this.$$origin=this.render()):console.error("widgets must be an array")}setRender(e){this.$render=e}$initPlugins(){var{plugins:e=[]}=this;e.forEach(e=>{De(e.apply)&&e.apply(this.$hooks,this)})}callPlugin(e,t){if(this.$hooks[e]){var s=this.$hooks[e][t];if(s){for(var i=arguments.length,a=new Array(i>2?i-2:0),r=2;r<i;r++)a[r-2]=arguments[r];return s.call(...a)}}}render(){var{el:e,store:t,panels:s,settings:i,env:a,view:o,pc:n,h5:l,Render:c,widgets:p,component:d}=this,u={store:t,panels:s,settings:i,env:a,view:o,pc:n,h5:l,Render:c,widgets:p,component:d,setRender:this.setRender.bind(this),callPlugin:this.callPlugin.bind(this)};this.callPlugin("life","beforeCreate",{ctx:this});var h=new r.a({extension:u,el:e,render:e=>e(Fe)});return this.callPlugin("life","created",{ctx:this,ins:h}),h}destroy(){this.$render=null,this.$$origin&&De(this.$$origin.$destroy)&&(this.callPlugin("life","beforeDestroy",{ctx:this}),this.$$origin.$destroy(),this.$$origin.$off(),this.store.$$store=null,this.callPlugin("life","destroyed",{ctx:this}),this.$hooks={})}}qe.Rule=i.Rule,qe.Worker=i.Worker,qe.Event=i.Event,qe.Store=i.Store,qe.Logic=i.Logic,qe.Context=i.Context,qe.Script=i.Script,qe.TypeBuilder=i.TypeBuilder,qe.Dict=i.Dict,qe.API=i.API,qe.constant=i.constant,qe.helper=i.helper,qe.schema=i.schema,qe.hook=i.hook,qe.render=i.render,qe.drag=i.drag;t.default=qe}]).default});